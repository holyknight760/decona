#demultiplex 필요없고, fasta 형태의 데이터베이스를 NCBI 형태의 데이터베이스로 변환하는데 용이
decona -f -l 800 -m 2100 -q 10 -c 0.80 -n 25 -M -B small_database_aquarium.fasta
#-B로 이미 하드에 만들어진 NCBI 데이터베이스를 기반으로 분석이 진행됨. 
decona -f -l 800 -m 2100 -q 10 -c 0.80 -n 25 -M -b /mnt/c/Wild_INU/decona/example_data/BLASTdatabase/small_database_aquarium.fasta
decona -f -l 800 -m 2100 -q 10 -c 0.80 -n 25 -M -b /mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta


decona -f -l 800 -m 2100 -q 10 -c 0.80 -n 25 -M -b /mnt/d/parasite_18S/ncbi-refseqs_1719ea-seqs-derep-uniq.fasta
decona -f -l 800 -m 2100 -q 10 -c 0.80 -n 25 -M -b /mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta
#Waring: When using a short fragment (<300 bases) please adjust kmer length ( -k ) accordingly
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 10 -M -b /mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta
#Blasting consensus sequences barcode17_concatenated/
#BLAST Database error: No alias or index file found for nucleotide database [/mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta] in search path [/mnt/c/Wild_INU/decona/example_data/parasite_18S/data/barcode17_concatenated/multi-seq::]
#Building a new DB
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 10 -M -B /mnt/c/Wild_INU/decona/example_data/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 10 -M -B /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta

#데이터베이스 fasta 파일만 자꾸 지정한 경로로 이동하게 되며, 다음과 같은 오류 메세지가 뜬다. 
#Building a new DB, current time: 09/25/2023 10:47:20
#New DB name:   /mnt/c/Wild_INU/decona/example_data/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
#New DB title:  /mnt/c/Wild_INU/decona/example_data/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
#Sequence type: Nucleotide
#Keep MBits: T
#Maximum file size: 1000000000B
#BLAST options error: File /mnt/c/Wild_INU/decona/example_data/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta does not exist
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 10 -M -b /mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta

#**-k****set custom kmer length, short reads require smaller kmer length (default 15)**
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 14 -M -b /mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta
##Building a new DB_>400Mb, not working!!
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 14 -M -B /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta

#when >=3ea folder make Clustering reads...
The error message you've received indicates that the `cd-hit-est` command, which is a part of the CD-HIT software package used for clustering sequences, is not found in your current environment's PATH.
#    conda install -c bioconda cd-hit
#    which cd-hit-est
#    which conda
#    export PATH="/home/holyknightt/miniconda3/envs/decona/bin/:$PATH"

#-B로 이미 하드에 만들어진 NCBI 데이터베이스를 기반으로 분석이 진행됨.
#notebook_7ea find
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 14 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
#notebook_9ea find and 간흡충은 Paragonimus westermani와 유사
decona -f -l 100 -m 2100 -q 10 -c 1.00 -n 25 -k 14 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
##18S_V9_300bp_9ea find and 간흡충은 Paragonimus westermani와 유사
decona -f -T 20 -l 100 -m 300 -q 10 -c 1.00 -n 5 -k 6 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
#re-cluster consensus sequences
decona -f -l 100 -m 2100 -q 10 -c 1.00 -n 25 -r 0.99 -R 500 -k 14 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
##barcode08_1950bp_1개씩 독립적으로 존재할 때, blast 결과가 없음. 
decona -f -T 20 -l 1850 -m 2300 -q 10 -c 1.00 -n 5 -k 15 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
##barcode08_1950bp_1개씩 독립적으로 존재할 때, 클러스터 사이즈 100이 되면 100개의 서열을 하나로 묶음. 그래서 많은 서열이 없어짐. 
decona -f -T 20 -l 1850 -m 2300 -q 10 -c 0.80 -n 100 -k 15 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
##barcode08_1950bp_1개씩 독립적으로 존재할 때, 클러스터 사이즈 100이 되면 5개의 서열을 하나로 묶음.  
decona -f -T 20 -l 1850 -m 2300 -q 10 -c 0.80 -n 5 -k 15 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
##barcode08_1950bp_1개씩 독립적으로 존재할 때, 클러스터 identity 0.8은 0.99보다 결과가 다양하다. 
decona -f -T 20 -l 1850 -m 2300 -q 10 -c 0.99 -n 5 -k 15 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
#re-cluster consensus sequences
decona -f -T 20 -l 1850 -m 2300 -q 10 -c 1.00 -n 5 -r 0.99 -R 500 -k 15 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta
-p

#desktop
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 14 -M -b /mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta
decona -f -l 100 -m 2100 -q 10 -c 0.80 -n 25 -k 14 -M -b /mnt/c/Users/holyknightt/'Geneious 2023.2 Data'/BLAST/data
##18S_V9_300bp
decona -f -T 20 -l 100 -m 300 -q 10 -c 1.00 -n 5 -k 14 -M -b /mnt/e/Nanopore/ncbi-refseqs_18S_v220513-derep-uniq.fasta


#https://www.readcube.com/library/6a892c3a-8653-4b22-88cb-6d624da7e92e:e7f9884f-3dda-4b66-91ff-8fc8ae5f027a
2kb: decona -f -T 20 -l 1800 -m 2350 -g 1 "GGATTACCCYACTATGC;max_error_rate=0.1;min_overlap=17…CTAGGGATAACAGCGCAATC;max_error_rate=0.1;min_overlap=17" -n 5 -r 0.99= -R 500 -M
18S_V9: decona -f -T 20 -l 100 -m 350 -g 1 "GTACACACCGCCCGTC;max_error_rate=0.1;min_overlap=20…TGATCCTTCTGCAGGTTCACCTAC;max_error_rate=0.1;min_overlap=20" -n 5 -r 0.99= -R 500 -k 6 -M
decona -f -T 20 -l 100 -m 300 -g 1 -n 5 -r 0.99 -R 500 -k 6 -M -b /mnt/d/parasite_18S/ncbi-refseqs_18S_v220513-derep-uniq.fasta



